<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="295px" preserveAspectRatio="none" style="width:463px;height:295px;background:#FFFFFF;" version="1.1" viewBox="0 0 463 295" width="463px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ezs9ygh1srir" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1ezs9ygh1srir)" height="105.2422" style="stroke:#000000;stroke-width:2.0;" width="439.5" x="10" y="86.7988"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="49" x2="49" y1="40.4883" y2="252.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="170.5" x2="170.5" y1="40.4883" y2="252.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="262.5" x2="262.5" y1="40.4883" y2="252.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="381.5" x2="381.5" y1="40.4883" y2="252.3516"/><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="27" y="25.5352">Client</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="20" y="251.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="27" y="271.8867">Client</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="57" x="140.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="147.5" y="25.5352">Server</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="57" x="140.5" y="251.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="147.5" y="271.8867">Server</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="98" x="211.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="218.5" y="25.5352">受信ファイル</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="98" x="211.5" y="251.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="218.5" y="271.8867">受信ファイル</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="112" x="323.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="330.5" y="25.5352">ロックファイル</text><rect fill="#FEFECE" filter="url(#f1ezs9ygh1srir)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="112" x="323.5" y="251.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="330.5" y="271.8867">ロックファイル</text><polygon fill="#A80036" points="159,67.7988,169,71.7988,159,75.7988,163,71.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="165" y1="71.7988" y2="71.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="56" y="67.0566">connect</text><path d="M10,86.7988 L148,86.7988 L148,93.7988 L138,103.7988 L10,103.7988 L10,86.7988 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="105.2422" style="stroke:#000000;stroke-width:2.0;" width="439.5" x="10" y="86.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93" x="25" y="100.3672">begin session</text><polygon fill="#A80036" points="159,121.4199,169,125.4199,159,129.4199,163,125.4199" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="165" y1="125.4199" y2="125.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="56" y="120.6777">Fメッセージ送信</text><polygon fill="#A80036" points="369.5,150.7305,379.5,154.7305,369.5,158.7305,373.5,154.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="171" x2="375.5" y1="154.7305" y2="154.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="178" y="149.9883">open(O_EXCL) エラー</text><polygon fill="#A80036" points="60,180.041,50,184.041,60,188.041,56,184.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="170" y1="184.041" y2="184.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="66" y="179.2988">Eメッセージ送信</text><polygon fill="#A80036" points="159,216.3516,169,220.3516,159,224.3516,163,220.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="165" y1="220.3516" y2="220.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="56" y="215.6094">close</text><polygon fill="#A80036" points="60,230.3516,50,234.3516,60,238.3516,56,234.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="170" y1="234.3516" y2="234.3516"/><!--MD5=[f7763895115c9fee55bc7f1f7f167ff4]
@startuml file-lock-err-sequence

participant "Client" as cl
participant "Server" as sv
participant "受信ファイル" as recvfile
participant "ロックファイル" as lockfile

cl -> sv: connect

group begin session
        cl -> sv: Fメッセージ送信
        sv -> lockfile: open(O_EXCL) エラー
        sv -> cl: Eメッセージ送信
end

cl -> sv: close
sv -> cl:

@enduml

PlantUML version 1.2021.14(Sat Nov 13 01:46:50 JST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>